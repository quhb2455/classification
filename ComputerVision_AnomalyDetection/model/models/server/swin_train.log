2022-10-05 05:58:34 - {'df_path': '../data/train_df.csv', 'save_path': '../model/swin_aug_v4_mixup_kfold', 'model_name': 'swin_base_patch4_window7_224_in22k', 'num_classes': 88, 'resize': 224, 'device': 'cuda:0', 'early_stopping': 5, 'epochs': 30, 'batch_size': 16, 'learning_rate': 0.0001, 'weight_decay': 0.01, 'cosine_lr_Tmax': 15, 'cosine_lr_eta_min': 1e-05, 'cutmix': False, 'mixup': True, 'resume': False, 'model_path': '../model/swin_aug_v4_mixup/21E_0.0382_swin_base_patch4_window7_224_in22k.pt', 'logging': True, 'kfold': 4}
2022-10-05 05:58:35 - Loading pretrained weights from url (https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_base_patch4_window7_224_22k.pth)
2022-10-05 05:59:25 - {'df_path': '../data/train_df.csv', 'save_path': '../model/swin_aug_v4_mixup_kfold', 'model_name': 'swin_base_patch4_window7_224_in22k', 'num_classes': 88, 'resize': 224, 'device': 'cuda:0', 'early_stopping': 5, 'epochs': 30, 'batch_size': 16, 'learning_rate': 0.0001, 'weight_decay': 0.01, 'cosine_lr_Tmax': 15, 'cosine_lr_eta_min': 1e-05, 'cutmix': False, 'mixup': True, 'resume': False, 'model_path': '../model/swin_aug_v4_mixup/21E_0.0382_swin_base_patch4_window7_224_in22k.pt', 'logging': True, 'kfold': 4}
2022-10-05 05:59:27 - Loading pretrained weights from url (https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_base_patch4_window7_224_22k.pth)
2022-10-05 06:00:42 - {'df_path': '../data/train_df.csv', 'save_path': '../model/swin_aug_v4_mixup_kfold', 'model_name': 'swin_base_patch4_window7_224_in22k', 'num_classes': 88, 'resize': 224, 'device': 'cuda:0', 'early_stopping': 5, 'epochs': 30, 'batch_size': 8, 'learning_rate': 0.0001, 'weight_decay': 0.01, 'cosine_lr_Tmax': 15, 'cosine_lr_eta_min': 1e-05, 'cutmix': False, 'mixup': True, 'resume': False, 'model_path': '../model/swin_aug_v4_mixup/21E_0.0382_swin_base_patch4_window7_224_in22k.pt', 'logging': True, 'kfold': 4}
2022-10-05 06:00:43 - Loading pretrained weights from url (https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_base_patch4_window7_224_22k.pth)
2022-10-05 06:01:14 - {'df_path': '../data/train_df.csv', 'save_path': '../model/swin_aug_v4_mixup_kfold', 'model_name': 'swin_base_patch4_window7_224_in22k', 'num_classes': 88, 'resize': 224, 'device': 'cuda:3', 'early_stopping': 5, 'epochs': 30, 'batch_size': 32, 'learning_rate': 0.0001, 'weight_decay': 0.01, 'cosine_lr_Tmax': 15, 'cosine_lr_eta_min': 1e-05, 'cutmix': False, 'mixup': True, 'resume': False, 'model_path': '../model/swin_aug_v4_mixup/21E_0.0382_swin_base_patch4_window7_224_in22k.pt', 'logging': True, 'kfold': 4}
2022-10-05 06:01:16 - Loading pretrained weights from url (https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_base_patch4_window7_224_22k.pth)
2022-10-05 06:01:49 - {'df_path': '../data/train_df.csv', 'save_path': '../model/swin_aug_v4_mixup_kfold', 'model_name': 'swin_base_patch4_window7_224_in22k', 'num_classes': 88, 'resize': 224, 'device': 'cuda:3', 'early_stopping': 5, 'epochs': 30, 'batch_size': 16, 'learning_rate': 0.0001, 'weight_decay': 0.01, 'cosine_lr_Tmax': 15, 'cosine_lr_eta_min': 1e-05, 'cutmix': False, 'mixup': True, 'resume': False, 'model_path': '../model/swin_aug_v4_mixup/21E_0.0382_swin_base_patch4_window7_224_in22k.pt', 'logging': True, 'kfold': 4}
2022-10-05 06:01:50 - Loading pretrained weights from url (https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_base_patch4_window7_224_22k.pth)
2022-10-05 06:03:43 - {'df_path': '../data/train_df.csv', 'save_path': '../model/swin_aug_v4_mixup_kfold', 'model_name': 'swin_base_patch4_window7_224_in22k', 'num_classes': 88, 'resize': 224, 'device': 'cuda:3', 'early_stopping': 5, 'epochs': 30, 'batch_size': 16, 'learning_rate': 0.0001, 'weight_decay': 0.01, 'cosine_lr_Tmax': 15, 'cosine_lr_eta_min': 1e-05, 'cutmix': False, 'mixup': True, 'resume': False, 'model_path': '../model/swin_aug_v4_mixup/21E_0.0382_swin_base_patch4_window7_224_in22k.pt', 'logging': True, 'kfold': 4}
2022-10-05 06:03:44 - Loading pretrained weights from url (https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_base_patch4_window7_224_22k.pth)
2022-10-05 06:08:22 - {'df_path': '../data/train_df.csv', 'save_path': '../model/swin_aug_v4_mixup_kfold', 'model_name': 'swin_base_patch4_window7_224_in22k', 'num_classes': 88, 'resize': 224, 'device': 'cuda:3', 'early_stopping': 5, 'epochs': 30, 'batch_size': 16, 'learning_rate': 0.0001, 'weight_decay': 0.01, 'cosine_lr_Tmax': 15, 'cosine_lr_eta_min': 1e-05, 'cutmix': False, 'mixup': True, 'resume': False, 'model_path': '../model/swin_aug_v4_mixup/21E_0.0382_swin_base_patch4_window7_224_in22k.pt', 'logging': True, 'kfold': 4}
2022-10-05 06:08:24 - Loading pretrained weights from url (https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_base_patch4_window7_224_22k.pth)
2022-11-05 00:23:38 - {'df_path': '../data/aug_v4_train_df.csv', 'save_path': '../model/swin_aug_v4_mixup_kfold', 'model_name': 'swin_base_patch4_window7_224_in22k', 'num_classes': 88, 'resize': 224, 'device': 'cuda:2', 'early_stopping': 5, 'epochs': 30, 'batch_size': 16, 'learning_rate': 0.0001, 'weight_decay': 0.01, 'cosine_lr_Tmax': 15, 'cosine_lr_eta_min': 1e-05, 'cutmix': False, 'mixup': True, 'resume': False, 'model_path': '../model/efficientnet_b3/21E_0.0382_swin_base_patch4_window7_224_in22k.pt', 'logging': True, 'kfold': 4}
2022-11-05 00:23:40 - Loading pretrained weights from url (https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_base_patch4_window7_224_22k.pth)
2022-11-05 00:24:02 - {'df_path': '../data/aug_v4_train_df.csv', 'save_path': '../model/swin_aug_v4_mixup_kfold', 'model_name': 'swin_base_patch4_window7_224_in22k', 'num_classes': 88, 'resize': 224, 'device': 'cuda:2', 'early_stopping': 5, 'epochs': 30, 'batch_size': 16, 'learning_rate': 0.0001, 'weight_decay': 0.01, 'cosine_lr_Tmax': 15, 'cosine_lr_eta_min': 1e-05, 'cutmix': False, 'mixup': True, 'resume': False, 'model_path': '../model/efficientnet_b3/21E_0.0382_swin_base_patch4_window7_224_in22k.pt', 'logging': True, 'kfold': 4}
2022-11-05 00:24:03 - Loading pretrained weights from url (https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_base_patch4_window7_224_22k.pth)
2022-11-05 00:25:10 - {'df_path': '../data/aug_v4_train_df.csv', 'save_path': '../model/swin_aug_v4_mixup_kfold', 'model_name': 'swin_base_patch4_window7_224_in22k', 'num_classes': 88, 'resize': 224, 'device': 'cuda:2', 'early_stopping': 5, 'epochs': 30, 'batch_size': 16, 'learning_rate': 0.0001, 'weight_decay': 0.01, 'cosine_lr_Tmax': 15, 'cosine_lr_eta_min': 1e-05, 'cutmix': False, 'mixup': True, 'resume': False, 'model_path': '../model/efficientnet_b3/21E_0.0382_swin_base_patch4_window7_224_in22k.pt', 'logging': True, 'kfold': 4}
2022-11-05 00:25:11 - Loading pretrained weights from url (https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_base_patch4_window7_224_22k.pth)
2022-11-05 05:44:09 - Loading pretrained weights from url (https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_base_patch4_window7_224_22k.pth)
===== k_fold : 3 / 4 =====
/opt/conda/lib/python3.7/site-packages/torch/functional.py:445: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1634272178570/work/aten/src/ATen/native/TensorShape.cpp:2157.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:45<00:00,  2.06it/s, Epoch=1, Mean train loss=1.888321, Mean train f1=0.234576]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:46<00:00,  2.91it/s, Mean valid loss=0.618779, Mean valid f1=0.683497]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:42<00:00,  2.07it/s, Epoch=2, Mean train loss=1.398283, Mean train f1=0.346346]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:45<00:00,  2.93it/s, Mean valid loss=0.394751, Mean valid f1=0.801784]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:42<00:00,  2.07it/s, Epoch=3, Mean train loss=1.259584, Mean train f1=0.356210]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:45<00:00,  2.93it/s, Mean valid loss=0.330421, Mean valid f1=0.835705]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:45<00:00,  2.06it/s, Epoch=4, Mean train loss=1.166471, Mean train f1=0.377828]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:45<00:00,  2.93it/s, Mean valid loss=0.253818, Mean valid f1=0.864197]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:43<00:00,  2.06it/s, Epoch=5, Mean train loss=1.107097, Mean train f1=0.398339]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:42<00:00,  2.97it/s, Mean valid loss=0.211181, Mean valid f1=0.886351]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:44<00:00,  2.06it/s, Epoch=6, Mean train loss=1.055448, Mean train f1=0.420928]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:46<00:00,  2.91it/s, Mean valid loss=0.163479, Mean valid f1=0.927851]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:44<00:00,  2.06it/s, Epoch=7, Mean train loss=0.995416, Mean train f1=0.421875]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:46<00:00,  2.90it/s, Mean valid loss=0.152135, Mean valid f1=0.931600]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:45<00:00,  2.06it/s, Epoch=8, Mean train loss=0.935396, Mean train f1=0.438628]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:43<00:00,  2.95it/s, Mean valid loss=0.111420, Mean valid f1=0.953994]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:43<00:00,  2.06it/s, Epoch=9, Mean train loss=0.894391, Mean train f1=0.437006]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:43<00:00,  2.95it/s, Mean valid loss=0.097635, Mean valid f1=0.954615]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:45<00:00,  2.06it/s, Epoch=10, Mean train loss=0.857021, Mean train f1=0.456809]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:43<00:00,  2.97it/s, Mean valid loss=0.087715, Mean valid f1=0.959817]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:44<00:00,  2.06it/s, Epoch=11, Mean train loss=0.825713, Mean train f1=0.465116]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:46<00:00,  2.91it/s, Mean valid loss=0.057445, Mean valid f1=0.975906]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:42<00:00,  2.07it/s, Epoch=12, Mean train loss=0.807089, Mean train f1=0.462221]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:45<00:00,  2.93it/s, Mean valid loss=0.062210, Mean valid f1=0.976601]
Early Stopping Step : [1 / 5]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:40<00:00,  2.07it/s, Epoch=13, Mean train loss=0.738011, Mean train f1=0.491960]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:45<00:00,  2.93it/s, Mean valid loss=0.061804, Mean valid f1=0.975815]
Early Stopping Step : [2 / 5]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:45<00:00,  2.06it/s, Epoch=14, Mean train loss=0.744785, Mean train f1=0.480271]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:44<00:00,  2.94it/s, Mean valid loss=0.044969, Mean valid f1=0.983642]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:44<00:00,  2.06it/s, Epoch=15, Mean train loss=0.738017, Mean train f1=0.468973]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:43<00:00,  2.96it/s, Mean valid loss=0.037470, Mean valid f1=0.987173]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:43<00:00,  2.06it/s, Epoch=16, Mean train loss=0.730809, Mean train f1=0.491017]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:45<00:00,  2.92it/s, Mean valid loss=0.038153, Mean valid f1=0.986170]
Early Stopping Step : [1 / 5]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:43<00:00,  2.06it/s, Epoch=17, Mean train loss=0.725493, Mean train f1=0.495493]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:44<00:00,  2.94it/s, Mean valid loss=0.036749, Mean valid f1=0.988623]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:46<00:00,  2.06it/s, Epoch=18, Mean train loss=0.707783, Mean train f1=0.497758]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:44<00:00,  2.95it/s, Mean valid loss=0.038920, Mean valid f1=0.985805]
Early Stopping Step : [1 / 5]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:44<00:00,  2.06it/s, Epoch=19, Mean train loss=0.737566, Mean train f1=0.485845]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:43<00:00,  2.96it/s, Mean valid loss=0.048508, Mean valid f1=0.982923]
Early Stopping Step : [2 / 5]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:44<00:00,  2.06it/s, Epoch=20, Mean train loss=0.730007, Mean train f1=0.493599]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:43<00:00,  2.95it/s, Mean valid loss=0.049424, Mean valid f1=0.981549]
Early Stopping Step : [3 / 5]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:42<00:00,  2.07it/s, Epoch=21, Mean train loss=0.754968, Mean train f1=0.496122]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:47<00:00,  2.89it/s, Mean valid loss=0.050955, Mean valid f1=0.976739]
Early Stopping Step : [4 / 5]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:42<00:00,  2.07it/s, Epoch=22, Mean train loss=0.786025, Mean train f1=0.474084]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:46<00:00,  2.90it/s, Mean valid loss=0.070150, Mean valid f1=0.970784]
Early Stopping Step : [5 / 5]
=== Early Stop ===



===== k_fold : 4 / 4 =====
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:47<00:00,  2.05it/s, Epoch=1, Mean train loss=1.892861, Mean train f1=0.247721]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:44<00:00,  2.95it/s, Mean valid loss=0.623591, Mean valid f1=0.684997]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:44<00:00,  2.06it/s, Epoch=2, Mean train loss=1.402737, Mean train f1=0.334584]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 484/484 [02:45<00:00,  2.92it/s, Mean valid loss=0.484852, Mean valid f1=0.765950]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 1452/1452 [11:44<00:00,  2.06it/s, Epoch=3, Mean train loss=1.291100, Mean train f1=0.359135]
  8%|█████████▌                                                                                                            | 39/484 [00:13<02:32,  2.92it/s, Mean valid loss=0.413169, Mean valid f1=0.794904]
  
 2022-11-05 06:26:58 - {'df_path': '../data/aug_v4_train_df.csv', 'save_path': '../model/swin_aug_v4_mixup_kfold', 'model_name': 'swin_base_patch4_window7_224_in22k', 'num_classes': 88, 'resize': 224, 'device': 'cuda:2', 'early_stopping': 5, 'epochs': 30, 'batch_size': 16, 'learning_rate': 0.0001, 'weight_decay': 0.01, 'cosine_lr_Tmax': 15, 'cosine_lr_eta_min': 1e-05, 'cutmix': False, 'mixup': True, 'resume': False, 'model_path': '../model/efficientnet_b3/21E_0.0382_swin_base_patch4_window7_224_in22k.pt', 'logging': True, 'kfold': 4}
2022-11-05 06:27:00 - Loading pretrained weights from url (https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_base_patch4_window7_224_22k.pth)
